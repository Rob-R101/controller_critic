<div class="game-info-container">
  <div class="game-banner">
    <img src="<%= @game.product_image %>" alt="<%= @game.title %> image">
  </div>
  <div class="game-title-description">
    <h2 class="game-rating"><%= @game.aggregated_rating ? (@game.aggregated_rating.to_f / 10).round(1) : "N/A" %></h2>
    <h1><%= @game.title %></h1>

    <div class="left-column">
      <p><%= @game.description %></p>
      <div class="game-buttons">
        <% if @user_game %>
          <%= button_to "Remove from My Games", my_game_path(@user_game), method: :delete, class: "btn btn-primary btn-lg" %>
        <% else %>
          <%= button_to "Add to My Games", game_my_games_path(@game), method: :post, class: "btn btn-outline-primary btn-lg" %>
        <% end %>

        <% if @user_wishlist %>
          <%= button_to "Remove from Wishlist", wishlist_path(@user_wishlist), method: :delete, class: "btn btn-primary btn-lg" %>
        <% else %>
          <%= button_to "Add to Wishlist", game_wishlists_path(@game), method: :post, class: "btn btn-outline-primary btn-lg" %>
        <% end %>
      </div>
    </div>

    <div class="game-details">
      <div class="console-logos">
  <% @game.platforms.each do |platform| %>
    <% platform_name = platform.name.downcase %>

    <%# Dynamically select icons based on platform name %>
    <% case platform_name %>
      <% when "playstation 4" %>
        <i class="fa-brands fa-playstation console-logo" title="PlayStation 4"></i>
      <% when "playstation 5" %>
        <i class="fa-brands fa-playstation console-logo" title="PlayStation 5"></i>
      <% when "playstation 2" %>
        <i class="fa-brands fa-playstation console-logo" title="PlayStation 2"></i>
      <% when "playstation 3" %>
        <i class="fa-brands fa-playstation console-logo" title="PlayStation 3"></i>
      <% when "xbox" %>
        <i class="fa-brands fa-xbox console-logo" title="Xbox"></i>
      <% when "xbox one" %>
        <i class="fa-brands fa-xbox console-logo" title="Xbox One"></i>
      <% when "xbox series x|s" %>
        <i class="fa-brands fa-xbox console-logo" title="Xbox X|S"></i>
      <% when "xbox 360" %>
        <i class="fa-brands fa-xbox console-logo" title="Xbox 360"></i>
      <% when "mac" %>
        <i class="fa-solid fa-laptop console-logo" title="MAC"></i>
      <% when "windows", "pc", "pc (microsoft windows)", "mac" %>
        <i class="fa-solid fa-laptop console-logo" title="PC"></i>
      <% when "meta quest 3" %>
        <i class="fa-brands fa-meta" title="Meta Quest 3"></i>
      <% when "meta quest 2" %>
        <i class="fa-brands fa-meta" title="Meta Quest 2"></i>
      <% else %>
        <i class="fa-solid fa-gamepad console-logo" title="<%= platform.name %>"></i>
        <%= platform.name %>
    <% end %>
  <% end %>
</div>

      <br>
      <h2><span class="light-text">Released </span> <%= @game.year_published || "N/A" %></h2>
      <h2><span class="light-text">Genre </span> <%= @game.genre || "Unknown Genre" %></h2>
      <h2><span class="light-text">Publisher </span> <%= @game.publisher || "N/A" %></h2>
    </div>
  </div>
</div>

<%= render "reviews/reviews", game: @game, reviews: @game.reviews %>
